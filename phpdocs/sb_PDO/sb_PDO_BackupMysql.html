<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">
		<head>
			<!-- template designed by Marco Von Ballmoos -->
			<title>Docs For Class sb_PDO_BackupMysql</title>
			<link rel="stylesheet" href="../media/stylesheet.css" />
			<meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1'/>
		</head>
		<body>
			<div class="page-body">			
<h2 class="class-name">Class sb_PDO_BackupMysql</h2>

<a name="sec-description"></a>
<div class="info-box">
	<div class="info-box-title">Description</div>
	<div class="nav-bar">
					<span class="disabled">Description</span> |
													<a href="#sec-var-summary">Vars</a> (<a href="#sec-vars">details</a>)
						|											<a href="#sec-method-summary">Methods</a> (<a href="#sec-methods">details</a>)
						
					</div>
	<div class="info-box-body">
        		<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">This script is used to backup all mysql databases on a server via mysqldump.</p>
<p class="description"><p>It is only suitable for databases that can be dumped using mysqldump.  The files are then gzippped into the dumps directory in the folder it was run in.  Dumps are broken down into numbered directorys.  1 is the newest and they  keep going up until max version.  When a dump directory goes beyond max version,  it is deleted.  Each time the script is run, the dump directories increment by 1.</p><p>The db credetials should be for root or a user that has SELECT access to every database</p></p>
	<ul class="tags">
				<li><span class="field">author:</span> Paul Visco paul.visco@roswellpark.org</li>
			</ul>
		<p class="notes">
			Located in <a class="field" href="_PDO---BackupMysql.php.html">/PDO/BackupMysql.php</a> (line <span class="field">14</span>)
		</p>
		
				
		<pre></pre>
	
			</div>
</div>



	<a name="sec-var-summary"></a>
	<div class="info-box">
		<div class="info-box-title">Variable Summary</span></div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
						<span class="disabled">Vars</span> (<a href="#sec-vars">details</a>)
							| 
									<a href="#sec-method-summary">Methods</a> (<a href="#sec-methods">details</a>)
							
								</div>
		<div class="info-box-body">
			<div class="var-summary">
																																																								<div class="var-title">
					<span class="var-type">PDO</span>
					<a href="#$db" title="details" class="var-name">$db</a>
				</div>
																<div class="var-title">
					<span class="var-type">boolean</span>
					<a href="#$debug" title="details" class="var-name">$debug</a>
				</div>
																<div class="var-title">
					<span class="var-type">string</span>
					<a href="#$dump_dir" title="details" class="var-name">$dump_dir</a>
				</div>
																<div class="var-title">
					<span class="var-type">array</span>
					<a href="#$ignore" title="details" class="var-name">$ignore</a>
				</div>
																<div class="var-title">
					<span class="var-type">integer</span>
					<a href="#$max_version" title="details" class="var-name">$max_version</a>
				</div>
											</div>
		</div>
	</div>

	<a name="sec-method-summary"></a>
	<div class="info-box">
		<div class="info-box-title">Method Summary</span></div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
																		<a href="#sec-var-summary">Vars</a> (<a href="#sec-vars">details</a>)
				 
				|
						<span class="disabled">Methods</span> (<a href="#sec-methods">details</a>)
		</div>
		<div class="info-box-body">			
			<div class="method-summary">
																																																																												
												<div class="method-definition">
											<span class="method-result">sb_PDO_BackupMysql</span>
										<a href="#__construct" title="details" class="method-name">__construct</a>
											(<span class="var-type">string</span>&nbsp;<span class="var-name">$db_host</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$db_user</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$db_pass</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">void</span>
										<a href="#__destruct" title="details" class="method-name">__destruct</a>
										()
									</div>
																<div class="method-definition">
											<span class="method-result">void</span>
										<a href="#backup" title="details" class="method-name">backup</a>
										()
									</div>
																<div class="method-definition">
											<span class="method-result">void</span>
										<a href="#check_dump_dir" title="details" class="method-name">check_dump_dir</a>
										()
									</div>
																<div class="method-definition">
											<span class="method-result">void</span>
										<a href="#connect_to_db" title="details" class="method-name">connect_to_db</a>
										()
									</div>
																<div class="method-definition">
											<span class="method-result">void</span>
										<a href="#dump_databases" title="details" class="method-name">dump_databases</a>
										()
									</div>
																<div class="method-definition">
											<span class="method-result">void</span>
										<a href="#log" title="details" class="method-name">log</a>
											(<span class="var-type">string</span>&nbsp;<span class="var-name">$message</span>)
									</div>
																<div class="method-definition">
											<span class="method-result">boolean</span>
										<a href="#recursive_delete" title="details" class="method-name">recursive_delete</a>
											(<span class="var-type">string</span>&nbsp;<span class="var-name">$dir</span>, [<span class="var-type">boolean</span>&nbsp;<span class="var-name">$del</span> = <span class="var-default">0</span>])
									</div>
																<div class="method-definition">
											<span class="method-result">void</span>
										<a href="#set_ignore" title="details" class="method-name">set_ignore</a>
											(<span class="var-type">Array</span>&nbsp;<span class="var-name">$array</span>)
									</div>
								</div>
		</div>
	</div>		

	<a name="sec-vars"></a>
	<div class="info-box">
		<div class="info-box-title">Variables</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
										<a href="#sec-var-summary">Vars</a> (<span class="disabled">details</span>)
						
			
										| 
									<a href="#sec-method-summary">Methods</a> (<a href="#sec-methods">details</a>)
							
					</div>
		<div class="info-box-body">
			<a name="var$db" id="$db"><!-- --></A>
<div class="oddrow">

	<div class="var-header">
		<span class="var-title">
			<span class="var-type">PDO</span>
			<span class="var-name">$db</span>
						(line <span class="line-number">26</span>)
		</span>
	</div>

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Connection to database</p>
	<ul class="tags">
				<li><span class="field">access:</span> protected</li>
			</ul>
	
	
		
		

</div>
<a name="var$debug" id="$debug"><!-- --></A>
<div class="evenrow">

	<div class="var-header">
		<span class="var-title">
			<span class="var-type">boolean</span>
			<span class="var-name">$debug</span>
			 = <span class="var-default"> true</span>			(line <span class="line-number">44</span>)
		</span>
	</div>

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Determines if log data is dumped to screen</p>
	<ul class="tags">
				<li><span class="field">access:</span> public</li>
			</ul>
	
	
		
		

</div>
<a name="var$dump_dir" id="$dump_dir"><!-- --></A>
<div class="oddrow">

	<div class="var-header">
		<span class="var-title">
			<span class="var-type">string</span>
			<span class="var-name">$dump_dir</span>
			 = <span class="var-default"> 'dumps/'</span>			(line <span class="line-number">32</span>)
		</span>
	</div>

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">The directory the data is dumped into, must include end /</p>
	<ul class="tags">
				<li><span class="field">access:</span> protected</li>
			</ul>
	
	
		
		

</div>
<a name="var$ignore" id="$ignore"><!-- --></A>
<div class="evenrow">

	<div class="var-header">
		<span class="var-title">
			<span class="var-type">array</span>
			<span class="var-name">$ignore</span>
			 = <span class="var-default">array()</span>			(line <span class="line-number">20</span>)
		</span>
	</div>

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">An array of databases to ignore</p>
	<ul class="tags">
				<li><span class="field">access:</span> protected</li>
			</ul>
	
	
		
		

</div>
<a name="var$max_version" id="$max_version"><!-- --></A>
<div class="oddrow">

	<div class="var-header">
		<span class="var-title">
			<span class="var-type">integer</span>
			<span class="var-name">$max_version</span>
			 = <span class="var-default"> 3</span>			(line <span class="line-number">38</span>)
		</span>
	</div>

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">The maximum version number to keep before deleting</p>
	<ul class="tags">
				<li><span class="field">access:</span> public</li>
			</ul>
	
	
		
		

</div>
						
		</div>
	</div>
	
	<a name="sec-methods"></a>
	<div class="info-box">
		<div class="info-box-title">Methods</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
															<a href="#sec-var-summary">Vars</a> (<a href="#sec-vars">details</a>)
																	<a href="#sec-method-summary">Methods</a> (<span class="disabled">details</span>)
						
		</div>
		<div class="info-box-body">
			<A NAME='method_detail'></A>

<a name="method__construct" id="__construct"><!-- --></a>
<div class="evenrow">
	
	<div class="method-header">
		<span class="method-title">Constructor __construct</span> (line <span class="line-number">60</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Connects to the database for SELECT and mysqldump</p>
<p class="description"><p><div class="src-code"><ol><li><div class="src-line">&nbsp;<span class="src-var">$backup&nbsp;</span>=&nbsp;<span class="src-key">new&nbsp;</span><span class="src-id"><a href="../sb_PDO/sb_PDO_BackupMysql.html">sb_PDO_BackupMysql</a></span><span class="src-sym">(</span><span class="src-str">'127.0.0.1'</span><span class="src-sym">,&nbsp;</span><span class="src-str">'root'</span><span class="src-sym">,&nbsp;</span><span class="src-str">'abc123'</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
<li><div class="src-line">&nbsp;<span class="src-comm">//optional</span></div></li>
<li><div class="src-line">&nbsp;<span class="src-var">$back</span><span class="src-sym">-&gt;</span><span class="src-id"><a href="../sb_PDO/sb_PDO_BackupMysql.html#var$max_version">max_version</a>&nbsp;</span>=&nbsp;<span class="src-num">3</span><span class="src-sym">;</span></div></li>
<li><div class="src-line">&nbsp;<span class="src-var">$backup</span><span class="src-sym">-&gt;</span><a href="../sb_PDO/sb_PDO_BackupMysql.html#methodbackup">backup</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></div></li>
</ol></div></p></p>
	<ul class="tags">
				<li><span class="field">access:</span> public</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">sb_PDO_BackupMysql</span>
		<span class="method-name">
			__construct
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$db_host</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$db_user</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$db_pass</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$db_host</span><span class="var-description">: The mysql database host</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$db_user</span><span class="var-description">: The mysql database user</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$db_pass</span><span class="var-description">: The mysql database pass</span>			</li>
				</ul>
		
			
	</div>
<a name="method__destruct" id="__destruct"><!-- --></a>
<div class="oddrow">
	
	<div class="method-header">
		<span class="method-title">Destructor __destruct</span> (line <span class="line-number">218</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Stamp the final time and move the dump file into the newest version directory</p>
	<ul class="tags">
				<li><span class="field">access:</span> public</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			__destruct
		</span>
				()
			</div>
	
		
			
	</div>
<a name="methodbackup" id="backup"><!-- --></a>
<div class="evenrow">
	
	<div class="method-header">
		<span class="method-title">backup</span> (line <span class="line-number">72</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Initiates the backup process</p>
	<ul class="tags">
				<li><span class="field">access:</span> public</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			backup
		</span>
				()
			</div>
	
		
			
	</div>
<a name="methodcheck_dump_dir" id="check_dump_dir"><!-- --></a>
<div class="oddrow">
	
	<div class="method-header">
		<span class="method-title">check_dump_dir</span> (line <span class="line-number">111</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">check to make sure dump directory exists and if not create it</p>
	<ul class="tags">
				<li><span class="field">access:</span> protected</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			check_dump_dir
		</span>
				()
			</div>
	
		
			
	</div>
<a name="methodconnect_to_db" id="connect_to_db"><!-- --></a>
<div class="evenrow">
	
	<div class="method-header">
		<span class="method-title">connect_to_db</span> (line <span class="line-number">96</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Connects to the database</p>
	<ul class="tags">
				<li><span class="field">access:</span> protected</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			connect_to_db
		</span>
				()
			</div>
	
		
			
	</div>
<a name="methoddump_databases" id="dump_databases"><!-- --></a>
<div class="oddrow">
	
	<div class="method-header">
		<span class="method-title">dump_databases</span> (line <span class="line-number">143</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Dump the database files and gzip, add version number</p>
	<ul class="tags">
				<li><span class="field">access:</span> protected</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			dump_databases
		</span>
				()
			</div>
	
		
			
	</div>
<a name="methodlog" id="log"><!-- --></a>
<div class="evenrow">
	
	<div class="method-header">
		<span class="method-title">log</span> (line <span class="line-number">177</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Send messages to stdout</p>
	<ul class="tags">
				<li><span class="field">access:</span> protected</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			log
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$message</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$message</span>			</li>
				</ul>
		
			
	</div>
<a name="methodrecursive_delete" id="recursive_delete"><!-- --></a>
<div class="oddrow">
	
	<div class="method-header">
		<span class="method-title">recursive_delete</span> (line <span class="line-number">194</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Recursively deletes the files in a diretory</p>
	<ul class="tags">
				<li><span class="field">access:</span> protected</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">boolean</span>
		<span class="method-name">
			recursive_delete
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$dir</span>, [<span class="var-type">boolean</span>&nbsp;<span class="var-name">$del</span> = <span class="var-default">0</span>])
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$dir</span><span class="var-description">: The directory path</span>			</li>
					<li>
				<span class="var-type">boolean</span>
				<span class="var-name">$del</span><span class="var-description">: Should directory itself be deleted upon completion</span>			</li>
				</ul>
		
			
	</div>
<a name="methodset_ignore" id="set_ignore"><!-- --></a>
<div class="evenrow">
	
	<div class="method-header">
		<span class="method-title">set_ignore</span> (line <span class="line-number">84</span>)
	</div> 
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">An array of database names to ignore during backup, also databases named</p>
<p class="description"><p>nobackup_* are ignore</p></p>
	<ul class="tags">
				<li><span class="field">access:</span> public</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			set_ignore
		</span>
					(<span class="var-type">Array</span>&nbsp;<span class="var-name">$array</span>)
			</div>
	
			<ul class="parameters">
					<li>
				<span class="var-type">Array</span>
				<span class="var-name">$array</span>			</li>
				</ul>
		
			
	</div>
						
		</div>
	</div>


	<p class="notes" id="credit">
		Documentation generated on Tue, 11 Oct 2011 00:27:22 -0400 by <a href="http://www.phpdoc.org" target="_blank">phpDocumentor 1.4.3</a>
	</p>
	</div></body>
</html>